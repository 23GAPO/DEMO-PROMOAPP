<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PROMOAPP</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>PROMOAPP</h1>
    </header>

    <div class="container">

        <div class="tabs" role="tablist">
            <button class="tab-btn active" data-view="inicio">Inicio</button>
            <button class="tab-btn" data-view="restaurantes">Restaurantes</button>
            <button class="tab-btn" data-view="promociones">Promociones</button>
        </div>

        <div class="layout">

            <section id="view-inicio" class="card">
                <div class="slider" id="slider">
                    <div class="slides">
                        <div class="slide"><img src="img/restaurantes/AntojitosLupillo.jpeg" alt="Antojitos Lupillo"></div>
                        <div class="slide"><img src="img/restaurantes/Azucar&sal.jpeg" alt="Azucar y Sal"></div>
                        <div class="slide"><img src="img/restaurantes/Comidachina.jpeg" alt="Comida China Buena Suerte"></div>
                        <div class="slide"><img src="img/restaurantes/Contodo.jpeg" alt="Con Todo o que?"></div>
                        <div class="slide"><img src="img/restaurantes/HotDogs.jpeg" alt="Area 639 Hotdogs"></div>
                        <div class="slide"><img src="img/restaurantes/LaPatrona.jpeg" alt="La Patrona 2020"></div>
                        <div class="slide"><img src="img/restaurantes/LaSierra.jpeg" alt="Pizzería La Sierra"></div>
                        <div class="slide"><img src="img/restaurantes/LosAjillos.jpeg" alt="Los Ajillos Restaurant"></div>
                        <div class="slide"><img src="img/restaurantes/Maax.jpeg" alt="Maax Pizza"></div>
                        <div class="slide"><img src="img/restaurantes/Mariscos.jpeg" alt="Mariscos El Rey Culichi"></div>
                        <div class="slide"><img src="img/restaurantes/Moctezuma.jpeg" alt="Restaurante Moctezuma"></div>
                        <div class="slide"><img src="img/restaurantes/Orsinis.jpeg" alt="Orsinis Pizzería"></div>
                        <div class="slide"><img src="img/restaurantes/Taqueria.jpeg" alt="El Borrego de Oro"></div>
                    </div>
                    <button class="btn prev" onclick="mover(-1)">❮</button>
                    <button class="btn next" onclick="mover(1)">❯</button>

                    <div class="dots" id="dots"></div>
                </div>
            </section>

            <section id="view-restaurantes" class="card" style="display:none;">
                <div class="filtros">
                    <input type="text" id="buscar" placeholder="Buscar restaurante...">
                </div>
                <div id="restaurantes-list" class="grid-restaurantes"></div> 
            </section>            
            
            <section id="view-promociones" class="card" style="display:none;">
                <div class="promos-header">
                    <h2>Promociones semanales</h2>
                    <div class="subtitle">Selecciona un día para ver promos</div>
                </div>
                <div class="day-list" id="days"></div>
                <div id="promos" class="promos-grid"></div>
            </section>

        </div>
    </div>
    
    <div id="menu-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="cerrarModal()">×</span>
            <h2 id="modal-title">Menú</h2>
            <div id="modal-body"></div>
        </div>
    </div>
    <script>
    // ========= 1. LÓGICA DEL CARRUSEL DE INICIO  =========
    let index = 0;
    let autoPlay;

    const slidesContainer = document.querySelector(".slides");
    const totalSlides = document.querySelectorAll("#view-inicio .slide").length;
    const dotsContainer = document.querySelector("#dots");

    // Crear dots
    if (dotsContainer) {
        for(let i = 0; i < totalSlides; i++){
            let d = document.createElement("span");
            d.classList.add("dot");
            d.onclick = () => irA(i);
            dotsContainer.appendChild(d);
        }
    }
    
    function actualizarCarrusel(){
        if(slidesContainer) {
            slidesContainer.style.transform = `translateX(-${index * 100}%)`;
        }

        document.querySelectorAll("#view-inicio .dot").forEach((d, i) => {
            d.classList.toggle("active", i === index);
        });
    }

    function mover(dir){
        index = (index + dir + totalSlides) % totalSlides;
        actualizarCarrusel();
        reiniciarAuto();
    }
    window.mover = mover;

    function irA(i){
        index = i;
        actualizarCarrusel();
        reiniciarAuto();
    }

    function auto(){
        autoPlay = setInterval(() => {
            index = (index + 1) % totalSlides;
            actualizarCarrusel();
        }, 3000);
    }

    function reiniciarAuto(){
        clearInterval(autoPlay);
        auto();
    }
    
    // ======== 2. DATOS Y LÓGICA PRINCIPAL (RESTAURANTES/PROMOS) ========

    // BASE DE DATOS DINÁMICA: HORARIOS ACTUALIZADOS
    const datosRestaurantes = [
        { 
            nombre: "Maax Pizza", 
            alimentos: "Pizza", 
            horario: {
                lunes: "10:00 a.m. - 9:00 p.m.",
                martes: "10:00 a.m. - 9:00 p.m.",
                miércoles: "10:00 a.m. - 9:00 p.m.",
                jueves: "10:00 a.m. - 9:00 p.m.",
                viernes: "10:00 a.m. - 9:00 p.m.",
                sábado: "10:00 a.m. - 9:00 p.m.",
                domingo: "10:00 a.m. - 9:00 p.m."
            }, 
            telefono: "6395011199", direccion: "https://www.google.com/maps/place/Maax+Pizza/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb13ea59dbacd9:0x9ec9df3af6251db9!8m2!3d28.2682562!4d-105.4801812!16s%2Fg%2F11c5bhq3s5?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "pizza", imagenes: ["img/restaurantes/Maax.jpeg"] 
        },
        { 
            nombre: "Azucar y Sal", 
            alimentos: "Desayunos", 
            horario: {
                lunes: "8:00 a.m. - 9:00 p.m.",
                martes: "8:00 a.m. - 9:00 p.m.",
                miércoles: "8:00 a.m. - 9:00 p.m.",
                jueves: "8:00 a.m. - 9:00 p.m.",
                viernes: "8:00 a.m. - 9:00 p.m.",
                sábado: "8:00 a.m. - 9:00 p.m.",
                domingo: "8:00 a.m. - 1:00 p.m."
            }, 
            telefono: "6391118787", direccion: "https://www.google.com/maps/place/Azucar+%26+Sal+Restaurante/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb13e6ee8311e5:0xf4bf2dc693ec2dd1!8m2!3d28.2846521!4d-105.494009!16s%2Fg%2F11fq8tr9s6?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "desayunos", imagenes: ["img/restaurantes/Azucar&sal.jpeg"] 
        },
        
        { 
            nombre: "Antojitos Lupillo", 
            alimentos: "Antojitos", 
            horario: {
                lunes: "Cerrado",
                martes: "Cerrado",
                miércoles: "Cerrado",
                jueves: "11:00 a.m. - 2:00 a.m.",
                viernes: "11:00 a.m. - 2:00 a.m.",
                sábado: "11:00 a.m. - 2:00 a.m.",
                domingo: "11:00 a.m. - 2:00 a.m."
            }, 
            telefono: "6391001187", direccion: "https://www.google.com/maps/place/Antojitos+Lupillo/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb1309540579c3:0xd9e2e5c2d569f8cc!8m2!3d28.2746653!4d-105.4850639!16s%2Fg%2F11h_6fbjq9?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "antojitos", imagenes: ["img/restaurantes/AntojitosLupillo.jpeg"] 
        },
        
        { 
            nombre: "La Patrona 2020", 
            alimentos: "Mariscos", 
            horario: {
                lunes: "12:00 p.m. - 7:00 p.m.",
                martes: "12:00 p.m. - 7:00 p.m.",
                miércoles: "12:00 p.m. - 7:00 p.m.",
                jueves: "12:00 p.m. - 7:00 p.m.",
                viernes: "12:00 p.m. - 7:00 p.m.",
                sábado: "12:00 p.m. - 7:00 p.m.",
                domingo: "12:00 p.m. - 7:00 p.m."
            }, 
            telefono: "6391528113", direccion: "https://www.google.com/maps/place/LA+PATRONA+2020/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb1336dc26ae57:0x8617c70368c72b88!8m2!3d28.2601455!4d-105.4765715!16s%2Fg%2F11j95c_lh1?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "mariscos", imagenes: ["img/restaurantes/LaPatrona.jpeg"] 
        },
        { 
            nombre: "Orsinis Pizzería", 
            alimentos: "Pizzería", 
            horario: {
                lunes: "11:00 a.m. - 10:00 p.m.",
                martes: "11:00 a.m. - 10:00 p.m.",
                miércoles: "11:00 a.m. - 10:00 p.m.",
                jueves: "11:00 a.m. - 10:00 p.m.",
                viernes: "11:00 a.m. - 10:00 p.m.",
                sábado: "11:00 a.m. - 10:00 p.m.",
                domingo: "11:00 a.m. - 10:00 p.m."
            }, 
            telefono: "6394730097", direccion: "https://www.google.com/maps/place/Orsinis+Pizzeria+Meoqui/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86ea423558a62e17:0x39b7e12c6c874525!8m2!3d28.2733729!4d-105.4838137!16s%2Fg%2F1tdz0dmv?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "pizza", imagenes: ["img/restaurantes/Orsinis.jpeg"] 
        },
        { 
            nombre: "Comida China Buena Suerte", 
            alimentos: "Comida China", 
            horario: {
                lunes: "12:00 p.m. - 7:30 p.m.",
                martes: "12:00 p.m. - 7:30 p.m.",
                miércoles: "12:00 p.m. - 7:30 p.m.",
                jueves: "12:00 p.m. - 7:30 p.m.",
                viernes: "12:00 p.m. - 7:30 p.m.",
                sábado: "12:00 p.m. - 7:30 p.m.",
                domingo: "12:00 p.m. - 7:30 p.m."
            }, 
            telefono: "6391785977", direccion: "https://www.google.com/maps/place/COMIDA+CHINA/@28.2670738,-105.4878193,15z/data=!3m1!4b1!4m6!3m5!1s0x86eb13eb2e138dcf:0x67d776877b544095!8m2!3d28.2670742!4d-105.477541!16s%2Fg%2F11xysxrddm?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "china", imagenes: ["img/restaurantes/Comidachina.jpeg"] 
        },
        { 
            nombre: "Con Todo o que?", 
            alimentos: "Antojitos", 
            horario: {
                lunes: "Cerrado",
                martes: "Cerrado",
                miércoles: "Cerrado",
                jueves: "Cerrado",
                viernes: "11:00 a.m. - 4:00 p.m.",
                sábado: "11:00 a.m. - 4:00 p.m.",
                domingo: "11:00 a.m. - 4:00 p.m."
            }, 
            telefono: "6391060040", direccion: "https://www.google.com/maps/place/Estaci%C3%B3n+Consuelo,+Obrera,+33130+Meoqui,+Chih./@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb139694838783:0xc3eca7ea8e1a854d!8m2!3d28.2672531!4d-105.4702183!16s%2Fg%2F11pv9bjnp4?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "antojitos", imagenes: ["img/restaurantes/Contodo.jpeg"] 
        },
        { 
            nombre: "El Borrego de Oro", 
            alimentos: "Carne/Borrego", 
            horario: {
                lunes: "9:00 a.m. - 7:00 p.m.",
                martes: "10:00 a.m. - 7:00 p.m.",
                miércoles: "9:00 a.m. - 9:00 p.m.",
                jueves: "9:00 a.m. - 9:00 p.m.",
                viernes: "9:00 a.m. - 9:00 p.m.",
                sábado: "9:00 a.m. - 9:00 p.m.",
                domingo: "9:00 a.m. - 6:00 p.m."
            }, 
            telefono: "6391067930", direccion: "https://www.google.com/maps/place/Taquer%C3%ADa+el+Borregode+Oro+-+Calle+Aldama/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb13c38e3aaaab:0xda3bb82b21712615!8m2!3d28.274711!4d-105.484791!16s%2Fg%2F11c2l1jg10?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "carne", imagenes: ["img/restaurantes/Taqueria.jpeg"] 
        },
        { 
            nombre: "Restaurante Moctezuma", 
            alimentos: "Mexicana", 
            horario: {
                lunes: "8:00 a.m. - 7:00 p.m.",
                martes: "8:00 a.m. - 7:00 p.m.",
                miércoles: "8:00 a.m. - 7:00 p.m.",
                jueves: "8:00 a.m. - 7:00 p.m.",
                viernes: "8:00 a.m. - 7:00 p.m.",
                sábado: "8:00 a.m. - 7:00 p.m.",
                domingo: "8:00 a.m. - 7:00 p.m."
            }, 
            telefono: "6391940975", direccion: "https://www.google.com/maps/place/Moctezuma+Restaurante+de+Pescados+y+Mariscos/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb1392ce99c6b5:0x79ce94a69049301b!8m2!3d28.2609761!4d-105.4767439!16s%2Fg%2F11cmtsyn7g?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "mexicana", imagenes: ["img/restaurantes/Moctezuma.jpeg"] 
        },
        { 
            nombre: "Los Ajillos Restaurant", 
            alimentos: "Mexicana", 
            horario: {
                lunes: "7:30 a.m. - 9:00 p.m.",
                martes: "7:30 a.m. - 9:00 p.m.",
                miércoles: "7:30 a.m. - 9:00 p.m.",
                jueves: "7:30 a.m. - 9:00 p.m.",
                viernes: "7:30 a.m. - 9:00 p.m.",
                sábado: "7:30 a.m. - 9:00 p.m.",
                domingo: "7:30 a.m. - 9:00 p.m."
            }, 
            telefono: "6391944331", direccion: "https://www.google.com/maps/place/Los+Ajillos+restaurant/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb13000efc049b:0xe8f6d1e0ecd0d98!8m2!3d28.2840094!4d-105.4942204!16s%2Fg%2F11wxmww9z_?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "mexicana", imagenes: ["img/restaurantes/LosAjillos.jpeg"] 
        },
        { 
            nombre: "Mariscos El Rey Culichi", 
            alimentos: "Mariscos", 
            horario: {
                lunes: "10:00 a.m. - 6:30 p.m.",
                martes: "10:00 a.m. - 6:30 p.m.",
                miércoles: "10:00 a.m. - 6:30 p.m.",
                jueves: "10:00 a.m. - 6:30 p.m.",
                viernes: "10:00 a.m. - 8:30 p.m.",
                sábado: "10:00 a.m. - 8:30 p.m.",
                domingo: "10:00 a.m. - 8:30 p.m."
            }, 
            telefono: "6391941825", direccion: "https://www.google.com/maps/place/%22MARISCOS+EL+REY+CULICHI%22/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb13c316048083:0x94e144398b84a58c!8m2!3d28.2608993!4d-105.4762436!16s%2Fg%2F11nxt27q3p?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "mariscos", imagenes: ["img/restaurantes/Mariscos.jpeg"] 
        },
        { 
            nombre: "Pizzería La Sierra", 
            alimentos: "Pizzería", 
            horario: {
                lunes: "8:00 a.m. - 9:30 p.m.",
                martes: "8:00 a.m. - 9:30 p.m.",
                miércoles: "8:00 a.m. - 9:30 p.m.",
                jueves: "8:00 a.m. - 9:30 p.m.",
                viernes: "8:00 a.m. - 9:30 p.m.",
                sábado: "8:00 a.m. - 9:30 p.m.",
                domingo: "8:00 a.m. - 9:30 p.m."
            }, 
            telefono: "6391920207", direccion: "https://www.google.com/maps/place/Pizzer%C3%ADa+La+Sierra+Meoqui/@28.4579481,-106.1355562,10z/data=!4m6!3m5!1s0x86eb13c485c29fe1:0xf273db6d0bfe5a03!8m2!3d28.2756915!4d-105.4863848!16s%2Fg%2F11c5rrwwq6?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "pizza", imagenes: ["img/restaurantes/LaSierra.jpeg"] 
        },
        { 
            nombre: "Area 639 Hotdogs", 
            alimentos: "Hotdogs", 
            horario: {
                lunes: "6:00 p.m. - 1:30 a.m.",
                martes: "Cerrado",
                miércoles: "6:00 p.m. - 1:30 a.m.",
                jueves: "6:00 p.m. - 1:30 a.m.",
                viernes: "6:00 p.m. - 1:30 a.m.",
                sábado: "6:00 p.m. - 3:00 a.m.",
                domingo: "6:00 p.m. - 1:30 a.m."
            }, 
            telefono: "6392305101", direccion: "https://www.google.com/maps/place/%C3%81rea+639+Hotdogs/@28.2636331,-105.4810745,17.5z/data=!4m6!3m5!1s0x86eb1300299ddc6f:0x3ad7ee49d829144a!8m2!3d28.2635884!4d-105.4794082!16s%2Fg%2F11wfvj3m6f?entry=ttu&g_ep=EgoyMDI1MTExNy4wIKXMDSoASAFQAw%3D%3D", comida: "hotdogs", imagenes: ["img/restaurantes/HotDogs.jpeg"] 
        }
    ];

    // DATOS DEL MENÚ 
    const datosMenu = { 
        "Maax Pizza": `<h4>Pizzas (Grande)</h4><ul><li>Pizza de 1 Ingrediente: MXN 120.00</li><li>Pizza Mexicana (Frijol, jalapeños, cebolla, salchicha, chorizo): MXN 175.00</li><li>Pizza Pastorera: MXN 185.00</li><li>Pizza Especial Max (Jamón, salami, champiñones, cebolla, etc.): MXN 185.00</li></ul><h4>Adicionales</h4><ul><li>Baguette Mexicano: MXN 80.00</li><li>Orden de papas gajo: MXN 45.00</li></ul>`,
        "Azucar y Sal": `<h4>Panadería y Desayunos</h4><ul><li>Chilaquiles y Enchiladas.</li><li>Emparedados, Baguette, Chapatas.</li><li>Panadería (Azúcar y Sal).</li><li>Bebidas Frías y Calientes.</li><li>Repostería (Pasteles y Postres).</li></ul>`,
        "Antojitos Lupillo": `<h4>Desayunos Caseros</h4><ul><li>Chilaquiles con Pollo / Huevo / Mixtos: $120.00 - $130.00</li><li>Huevo con Chorizo / Jamón / Papa / a la Mexicana: $110.00 - $120.00</li><li>Omelette de Jamón o a la Mexicana: $120.00</li></ul><h4>Comidas Caseras</h4><ul><li>Milanesa de Pollo o Res Empanizada: $130.00</li><li>Enchiladas Suizas: $130.00</li><li>Bistec a la Mexicana: $140.00</li></ul>`,
        "La Patrona 2020": `<h4>Mariscos y Carnes</h4><p>Se encontraron diferentes menús para La Patrona, incluyendo tacos de sirloin, hamburguesas, flautas y sopes. El menú puede variar por sucursal.</p><ul><li>Orden de 4 Tacos de Sirloin asado al carbón.</li><li>Hamburguesa de sirloin.</li><li>Flautas de pollo o papa.</li><li>Chilaquiles rellenos.</li></ul>`,
        "Orsinis Pizzería": `<h4>Pizzas y Pastas (Precios de referencia)</h4><ul><li>Pizza Hawaiana: MX$99.00</li><li>Pizza Mediana 11": MX$179.00</li><li>Pizza Grande 13": MX$238.00</li><li>Orsinis Especial (Jamón, salami, chorizo, champiñón, etc.): MX$111.00</li><li>Spaguetti Bolognese: MX$121.00</li><li>Fettuccine Alfredo: MX$123.00</li></ul>`,
        "Comida China Buena Suerte": `<h4>Paquetes y Platillos (Precios de referencia)</h4><ul><li>Paquete Chico Arroz + Guiso: $ 99.00</li><li>Paquete 3 Guisos + Acompañamiento: $ 160.00</li><li>Arroz / Espagueti: $ 74.00 (Porción generosa)</li><li>Pollo Agridulce / Pollo Empanizado / Res con Brócoli: $ 81.00 - $87.00</li></ul>`,
        "Con Todo o que?": `<p style="text-align:center;">**Menú no disponible en línea.** Por favor, contacte directamente al restaurante para consultar sus opciones.</p>`,
        "El Borrego de Oro": `<h4>Tacos y Burritos (Precios de referencia)</h4><ul><li>Orden de Tacos Bistec de Res (4 tacos): $100.00</li><li>Burrito de Bistec de Res (30cm): $120.00</li><li>Orden de Tacos Combinados (Res y Puerco): $100.00</li><li>Orden de Tacos Barbacoa de Puerco: $100.00</li></ul>`,
        "Restaurante Moctezuma": `<h4>Hamburguesas y Cortes (Precios de referencia)</h4><ul><li>Patata Bacon Burger / La 4 Quesos: $175 - $195</li><li>Hamburguesa BALBOA (300g Sirloin, doble queso, panela, piña): $199</li><li>Rib Eye 500g / Arrachera 300g (Cortes a la Parrilla)</li><li>Parrillada Sonora (1.5 Kg de varias carnes): $1,650</li></ul>`,
        "Los Ajillos Restaurant": `<p style="text-align:center;">**Menú no disponible en línea.** Por favor, contacte directamente al restaurante para consultar sus opciones.</p>`,
        "Mariscos El Rey Culichi": `<h4>Especialidades (Precios de referencia en USD, pueden variar)</h4><ul><li>La Torre de Mariscos: $27.99</li><li>La Botana Placosa: $27.99</li><li>Aguachiles Negros o Verdes: $19.99</li><li>Taco de Camarón / Pescado: $3.99 +</li><li>Quesadilla de Camarón: $12.99 +</li></ul>`,
        "Pizzería La Sierra": `<h4>Pizzas y Más</h4><ul><li>Pizza La Sierra (Salami, pepperoni, champiñones, etc.)</li><li>Pizza Hawaiana / Ranchera / Carne Asada / Pollo BBQ.</li><li>Hamburguesa La Sierra (Res, queso, jamón, piña).</li><li>Complementos: Papas Nachos, Papas Francesas, Alitas.</li><li>Desayunos & Hot Cakes.</li></ul>`,
        "Area 639 Hotdogs": `<p style="text-align:center;">**Menú no disponible en el snippet de búsqueda.** El restaurante se especializa en Hotdogs, por favor, contacte para más detalles.</p>`
    };

    const datosPromos = [ 
        { restaurante: "Maax Pizza", promo: "¡La promo clásica! 2 pizza grandes a $299.", dia: "Todos los Días" },
        { restaurante: "Azucar y Sal", promo: "Desayuno completo: Chilaquiles + Café + Jugo por $120.", dia: "Lunes" },
        { restaurante: "Mariscos La Patrona 2020", promo: "2x1 en tacos de camarón y pescado.", dia: "Viernes" },
        { restaurante: "Orsinis Pizzería", promo: "Pizza familiar de un ingrediente + refresco 2L por $250.", dia: "Domingo" },
        { restaurante: "Area 639 Hotdogs", promo: "Hotdog gigante + papas + agua por $90.", dia: "Miércoles" },
        { restaurante: "El Borrego de Oro", promo: "20% de descuento en barbacoa para llevar.", dia: "Domingo" }
    ];

    // Elementos del DOM
    const contenedorRestaurantes = document.getElementById('restaurantes-list');
    const inputBuscar = document.getElementById('buscar');
    const modal = document.getElementById('menu-modal');
    const tabs = document.querySelectorAll(".tab-btn");
    const views = ["view-inicio", "view-restaurantes", "view-promociones"];
    const diasSemana = ['domingo', 'lunes', 'martes', 'miércoles', 'jueves', 'viernes', 'sábado'];

    // --- LÓGICA DE HORARIO Y ESTADO ---
    
    function convertirA_Minutos(horaStr) {
        if (!horaStr || horaStr.toLowerCase().includes('n/a')) return -1;
        
        // 1. Limpia puntos y comas globales para estandarizar el string (Ej: "8:00 a.m." -> "8:00 am")
        const horaLimpia = horaStr.replace(/[.,]/g, '').trim(); 
        
        // 2. Separa el tiempo (HH:MM) del indicador AM/PM
        const partes = horaLimpia.split(/([ap]\.?m\.?)/i).map(s => s.trim()).filter(s => s);

        if (partes.length < 2) return -1;
        
        let [tiempo, ampm] = partes;
        
        // ampm ahora es 'am' o 'pm' (sin puntos, gracias a la limpieza en horaLimpia)
        ampm = ampm.toLowerCase().replace('.', ''); 

        let [horas, minutos] = tiempo.split(':').map(Number);
        if (isNaN(minutos)) minutos = 0; // Si no hay minutos (ej: "10am"), se asume 0

        // CORRECCIÓN: Se cambia la comparación de 'p.m' a 'pm' y de 'a.m' a 'am' 
        // para que coincida con el valor limpiado de la variable 'ampm'.
        if (ampm === 'pm' && horas !== 12) {
            horas += 12;
        } else if (ampm === 'am' && horas === 12) {
            horas = 0; 
        }
        return horas * 60 + minutos;
    }

    function determinarEstado(horarioData) {
        if (typeof horarioData !== 'object' || horarioData === null) {
            return { estado: 'Desconocido', mensaje: 'Horario no detallado' };
        }

        const ahora = new Date();
        const diaActual = diasSemana[ahora.getDay()];
        const minutosActuales = ahora.getHours() * 60 + ahora.getMinutes();
        
        const horarioHoyStr = horarioData[diaActual];

        if (horarioHoyStr.toLowerCase().includes('cerrado')) {
            // Buscamos cuándo abre el día siguiente si el horario de hoy es 'Cerrado'
            let mensaje = 'Cerrado hoy';
            for (let i = 1; i <= 7; i++) {
                const diaSiguiente = diasSemana[(ahora.getDay() + i) % 7];
                const horarioDiaSiguiente = horarioData[diaSiguiente];
                if (!horarioDiaSiguiente.toLowerCase().includes('cerrado')) {
                    const partesProx = horarioDiaSiguiente.split(' - ');
                    if (partesProx.length === 2) {
                        mensaje = `Abre el ${diaSiguiente.charAt(0).toUpperCase() + diaSiguiente.slice(1)} a las ${partesProx[0]}`;
                    }
                    break;
                }
            }
            return { estado: 'Cerrado', mensaje: mensaje };
        }
        
        const partesHorario = horarioHoyStr.split(' - ').map(s => s.trim()).filter(s => s);
        
        if (partesHorario.length < 2) {
             return { estado: 'Desconocido', mensaje: horarioHoyStr };
        }
        
        const [horaAperturaStr, horaCierreStr] = partesHorario;

        const aperturaMin = convertirA_Minutos(horaAperturaStr);
        let cierreMin = convertirA_Minutos(horaCierreStr);

        if (aperturaMin === -1 || cierreMin === -1) {
             return { estado: 'Desconocido', mensaje: horarioHoyStr };
        }

        let minutosActualesAjustados = minutosActuales;

        // Manejo de horarios que pasan de medianoche (Ej: 6:00 p.m. - 1:30 a.m.)
        if (cierreMin < aperturaMin) {
            cierreMin += 24 * 60; 
            
            // Si la hora actual es antes de la apertura (pero después de medianoche)
            if (minutosActuales >= 0 && minutosActuales < aperturaMin) {
                minutosActualesAjustados += 24 * 60;
            }
        }
        
        if (minutosActualesAjustados >= aperturaMin && minutosActualesAjustados < cierreMin) {
            return { estado: 'Abierto', mensaje: `Cierra a las ${horaCierreStr}` };
        } else {
            // Buscamos la hora de apertura del día siguiente si ya cerró hoy
            let mensajeApertura = `Abre hoy a las ${horaAperturaStr}`;
            
            // Si ya pasó la hora de cierre de hoy (o si cerró y estamos a la medianoche)
            if (minutosActuales >= cierreMin) {
                
                // Si el horario de hoy terminó después de medianoche, ya está cerrado hasta mañana.
                if (cierreMin > 24 * 60) {
                    mensajeApertura = `Cerrado hasta mañana`;
                } else {
                     // Si cerró a una hora normal, buscamos el próximo día de apertura
                    for (let i = 1; i <= 7; i++) {
                        const diaSiguiente = diasSemana[(ahora.getDay() + i) % 7];
                        const horarioDiaSiguiente = horarioData[diaSiguiente];
                        if (!horarioDiaSiguiente.toLowerCase().includes('cerrado')) {
                            const partesProx = horarioDiaSiguiente.split(' - ');
                            if (partesProx.length === 2) {
                                mensajeApertura = `Abre el ${diaSiguiente.charAt(0).toUpperCase() + diaSiguiente.slice(1)} a las ${partesProx[0]}`;
                            }
                            break;
                        } else if (i === 7) {
                            mensajeApertura = 'Cerrado permanentemente o por la semana';
                        }
                    }
                }
            } else if (minutosActuales < aperturaMin) {
                // Si aún no abre hoy
                mensajeApertura = `Abre hoy a las ${horaAperturaStr}`;
            }

            return { estado: 'Cerrado', mensaje: mensajeApertura };
        }
    }

    // --- FIN LÓGICA DE HORARIO Y ESTADO ---
    
    // UI: Funciones del Modal
    function mostrarMenu(nombreRestaurante) { 
        const menuHTML = datosMenu[nombreRestaurante] || '<p>Menú no encontrado.</p>';
        document.getElementById('modal-title').textContent = `Menú de ${nombreRestaurante}`;
        document.getElementById('modal-body').innerHTML = menuHTML;
        modal.style.display = 'block';
    }
    window.mostrarMenu = mostrarMenu;

    function cerrarModal() { 
        modal.style.display = 'none';
    }
    window.cerrarModal = cerrarModal;

    window.onclick = function(event) {
        if (event.target == modal) {
            cerrarModal();
        }
    }
    
    function cambiarVista(vista) { 
        views.forEach(id => {
            const section = document.getElementById(id);
            if(section) section.style.display = 'none';
        });

        const targetView = document.getElementById(`view-${vista}`);
        if(targetView) targetView.style.display = 'block';

        if (vista === 'restaurantes' && contenedorRestaurantes.innerHTML === '') {
             filtrar();
        }
    }
    
    // RENDERIZAR RESTAURANTES 
    function renderizarRestaurantes(lista) {
        if (!lista || lista.length === 0) {
            contenedorRestaurantes.innerHTML = `<div class="card card-message"><p>No se encontraron restaurantes.</p></div>`;
            return;
        }

        contenedorRestaurantes.innerHTML = lista.map((rest, indice) => {
            const tieneImagenes = Array.isArray(rest.imagenes) && rest.imagenes.length > 0;
            const htmlImagenes = tieneImagenes ? `
                <div class="carousel" data-idx="${indice}">
                    ${rest.imagenes.map(src => `<img src="${src}" alt="Imágen de ${rest.nombre}">`).join('')}
                    ${rest.imagenes.length > 1 ? `<button class="nav prev" aria-label="Anterior">◀</button><button class="nav next" aria-label="Siguiente">▶</button>` : ''}
                    ${rest.imagenes.length > 1 ? `<div class="dots">${rest.imagenes.map((_, i) => `<span class="dot" data-dot-index="${i}"></span>`).join('')}</div>` : ''}
                </div>
            ` : `<div class="carousel" data-idx="${indice}"><div class="no-img-placeholder">Sin imagen disponible</div></div>`;

            const textoDireccion = rest.direccion === 'N/A' || rest.direccion === '' ? 'N/D' : 'Ver Ubicación';
            const direccionHTML = (rest.direccion === 'N/A' || rest.direccion === '') 
                                    ? 'N/D' 
                                    : `<a href="${rest.direccion}" target="_blank">${textoDireccion}</a>`;

            // Lógica del Estado
            const estado = determinarEstado(rest.horario);
            const estadoClase = estado.estado === 'Abierto' ? 'estado-abierto' : (estado.estado === 'Cerrado' ? 'estado-cerrado' : 'estado-desconocido');

            // Lógica del Horario Detallado (PARA EL DESPLEGABLE)
            const esHorarioDetallado = typeof rest.horario === 'object';
            let htmlDetalleHorario = '';

            if (esHorarioDetallado) {
                const detalleItems = diasSemana.map(dia => {
                    const horaDia = rest.horario[dia] || 'N/A';
                    return `<li><strong>${dia.charAt(0).toUpperCase() + dia.slice(1)}:</strong> ${horaDia}</li>`;
                }).join('');
                
                const toggleID = `detalle-${indice}`;
                
                // MOSTRAR ESTADO + HORA ACTUAL + FLECHA DESPLEGABLE
                htmlDetalleHorario = `
                    <p class="horario-toggle" onclick="toggleHorario('${toggleID}', this)">
                        <span class="${estadoClase}">● ${estado.estado}</span> ${estado.mensaje} <span class="arrow">▼</span>
                    </p>
                    <div id="${toggleID}" class="horario-detalle">
                        <ul>${detalleItems}</ul>
                    </div>
                `;
            } else {
                // FALLBACK si el horario no es objeto (aunque ya todos lo son)
                htmlDetalleHorario = `
                    <p><strong>Horario:</strong> ${rest.horario || 'N/A'}</p>
                    <p><span class="${estadoClase}">● ${estado.estado}</span> (${estado.mensaje})</p>
                `;
            }

            return `
                <div class="card" data-nombre="${rest.nombre.toLowerCase()}">
                    <div class="rest-row">
                        ${htmlImagenes}
                        <div class="rest-meta">
                            <div>
                                <h3 class="rest-title-clickable" onclick="mostrarMenu('${rest.nombre.replace(/'/g, "\\'")}')">${rest.nombre}</h3>
                                <p><strong>Tipo:</strong> ${rest.comida || rest.alimentos || 'N/A'}</p>
                                ${htmlDetalleHorario} <p><strong>Tel:</strong> ${rest.telefono || 'N/A'}</p>
                                <p><strong>Dirección:</strong> ${direccionHTML}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }).join('');

        inicializarCarruseles();
    }
    
    // Función para desplegar/contraer el detalle del horario 
    function toggleHorario(id, element) { 
        const detalle = document.getElementById(id);
        const arrow = element.querySelector('.arrow');
        if (detalle.style.maxHeight) {
            detalle.style.maxHeight = null;
            arrow.textContent = '▼';
        } else {
            detalle.style.maxHeight = detalle.scrollHeight + "px";
            arrow.textContent = '▲';
        }
    }
    window.toggleHorario = toggleHorario;
    
    // FILTRADO DE RESTAURANTES 
    function filtrar() { 
        const busqueda = inputBuscar.value.trim().toLowerCase();

        const resultados = datosRestaurantes.filter(rest => {
            const nombre = (rest.nombre || '').toLowerCase();
            const coincideNombre = nombre.includes(busqueda);
            return coincideNombre;
        });

        renderizarRestaurantes(resultados);
    }
    
    // CARRUSEL DE TARJETAS 
    function inicializarCarruseles() { 
        document.querySelectorAll('.carousel').forEach(carrusel => {
            const imagenes = Array.from(carrusel.querySelectorAll('img'));
            if (imagenes.length === 0) return;
            let indiceActual = 0;
            const botonSiguiente = carrusel.querySelector('.next');
            const botonAnterior = carrusel.querySelector('.prev');
            const puntos = Array.from(carrusel.querySelectorAll('.dot'));

            function actualizarPuntos() {
                puntos.forEach((punto, i) => {
                    punto.classList.toggle('active', i === indiceActual);
                });
            }

            function mostrarImagen(i) {
                imagenes.forEach((img, idx) => img.style.display = (idx === i) ? 'block' : 'none');
                actualizarPuntos();
            }

            if (botonSiguiente && botonAnterior) {
                botonSiguiente.onclick = () => { indiceActual = (indiceActual + 1) % imagenes.length; mostrarImagen(indiceActual); };
                botonAnterior.onclick = () => { indiceActual = (indiceActual - 1 + imagenes.length) % imagenes.length; mostrarImagen(indiceActual); };
            }
            puntos.forEach(punto => {
                punto.addEventListener('click', (e) => {
                    const indicePunto = parseInt(e.target.getAttribute('data-dot-index'));
                    indiceActual = indicePunto;
                    mostrarImagen(indiceActual);
                });
            });

            mostrarImagen(0);
        });
    }

    // PROMOCIONES POR DÍA 
    const ordenDias = ['Todos', 'Lunes','Martes','Miércoles','Jueves','Viernes','Sábado','Domingo'];
    let promosAgrupadasPorDia = {};
    let diaSeleccionado = 'Todos';

    function agruparPromos() { 
        promosAgrupadasPorDia = {};
        ordenDias.forEach(d => promosAgrupadasPorDia[d] = []);

        datosPromos.forEach(promo => {
            const diaRaw = (promo.dia || '').toLowerCase();

            if (diaRaw.includes('todos')) { promosAgrupadasPorDia['Todos'].push(promo); } 
            else {
                let coincidencias = false;
                ordenDias.slice(1).forEach(dia => {
                    if (diaRaw.includes(dia.toLowerCase().substring(0, 3))) {
                        promosAgrupadasPorDia[dia].push(promo);
                        coincidencias = true;
                    }
                });
                if (!coincidencias && !diaRaw.includes('todos')) { promosAgrupadasPorDia['Todos'].push(promo); }
            }
        });
    }

    function renderizarSelectorDias() { 
        contenedorDias.innerHTML = ordenDias.map(d => `<button class="day-btn" data-day="${d}">${d}</button>`).join('');
        contenedorDias.querySelectorAll('.day-btn').forEach(boton => {
            boton.addEventListener('click', () => {
                diaSeleccionado = boton.getAttribute('data-day');
                renderizarPromosPorDia(diaSeleccionado);
                contenedorDias.querySelectorAll('.day-btn').forEach(b => { b.classList.remove('active'); });
                boton.classList.add('active');
            });
        });
        const primerBoton = contenedorDias.querySelector('.day-btn');
        if (primerBoton) { primerBoton.click(); }
    }
    window.renderizarSelectorDias = renderizarSelectorDias;

    function renderizarPromosPorDia(dia) { 
        const promosPermanentes = datosPromos.filter(p => (p.dia || '').toLowerCase().includes('todos'));
        let listaPromos = [];
        
        if (dia === 'Todos') {
            listaPromos = promosAgrupadasPorDia['Todos'];
        } else {
            const promosDiaEspecifico = (promosAgrupadasPorDia[dia] || []);
            listaPromos = [...new Set([...promosPermanentes, ...promosDiaEspecifico])];
        }

        if (!listaPromos || listaPromos.length === 0) {
            contenedorPromos.innerHTML = `<div class="promo-card promo-message"><p>No hay promociones disponibles para **${dia}**.</p></div>`;
            return;
        }

        contenedorPromos.innerHTML = listaPromos.map(promo => {
            const esPermanente = (promo.dia || '').toLowerCase().includes('todos');
            return `
                <div class="promo-card ${esPermanente ? 'promo-permanent' : ''}">
                    <h3>${promo.restaurante}</h3>
                    <p class="promo-day-label">**${promo.dia}**</p>
                    <p>${promo.promo}</p>
                </div>
            `;
        }).join('');
    }

    // Event listeners del HTML
    tabs.forEach(btn => {
        btn.addEventListener("click", (e) => {
            tabs.forEach(b => b.classList.remove("active"));
            e.currentTarget.classList.add("active");
            const view = e.currentTarget.dataset.view;
            cambiarVista(view);
        });
    });

    inputBuscar.addEventListener('input', filtrar);


    // Inicialización al cargar la página
    agruparPromos();
    actualizarCarrusel();
    auto();
    cambiarVista('inicio');
</script>

</body>
</html>